---
title: restfule-result-status
date: 2018-04-19 17:48:29
tags:
categories:
---
# 参考文档
http://xiaochutian.github.io/2017/08/01/design-of-server-status-code-1/
http://xiaochutian.github.io/2017/08/03/design-of-server-status-code-2/


# 作者的设计
自定义错误代码，HTTP状态码统一为200。
为什么我不复用HTTP状态码？

- HTTP状态码可能不够用。跟项目业务相关的错误细节无法反应出来。
- HTTP状态码应该属于HTTP协议的定义之中。项目中服务器与客户端的协议，应该是HTTP的上层协议。上层协议不应该知道和依赖底层协议的细节。

## 协议设计
HTTP状态码统一为200。Result对象里面的code为0表示正常返回，非0表示异常返回。 
异常详情如下：

4XXXX，表示客户端错误（参数问题等）
5XXXX，表示服务器错误（服务器的bug导致的异常）
6XXXX，表示业务逻辑上的异常逻辑的状态码（用于客户端执行异常逻辑流）

> 注：五位的状态码分为三个部分。X-XX-XX表示：错误类别-项目或模块编号-具体错误编号


这可以理解为，需求分析的时候，会有一个『主要成功场景』和一些『备选事件流』。 
主要成功场景 的返回code为0，而 备选事件流 的返回code为6XXXX。

> 举个栗子：有一个叫做『练耳大师』的产品，音乐爱好者可以在里面做乐感训练。 
> 产品里面有一个功能叫做『练习分析』。产品规定某一种练习，需要练习超过30道题才能进行分析。
> 所以，在用户没有做满30道题，并且点了『练习分析』按钮的时候。服务器逻辑是完全正确执行的，发现用户没有做满30道题，这个时候就返回6XXXX给客户端。 
> 客户端在获取到这个状态码就知道该执行『备选事件流』：提示用户『必须要做满30道题才能分析哦~』。

### 3.2.1 客户端错误 {#321-客户端错误}

| code | 说明 |
| :--- | :--- |
| 40000 | 客户端错误，通用 |
| 40001 | 客户端参数非法 |
| 40002 | 客户端参数json不符合格式要求 |

### 3.2.2 服务器（api）错误 {#322-服务器api错误}

| code | 说明 |
| :--- | :--- |
| 50000 | 服务器（api）错误，通用 |

### 3.2.3 服务器（dubbo）错误 {#323-服务器dubbo错误}

| code | 说明 |
| :--- | :--- |
| 60000 | 服务器（dubbo）错误，通用 |
